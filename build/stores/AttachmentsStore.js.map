{"version":3,"sources":["../../src/stores/AttachmentsStore.js"],"names":["AttachmentsStore","getInitialState","attachments","List","selectedIndex","reduce","state","action","type","ATTACHMENT_MODAL_SHOW","ATTACHMENT_MODAL_HIDE","ATTACHMENT_SELECT","index","ATTACHMENT_CHANGE","changedAttachment","get","set","sendAsPicture","ATTACHMENT_DELETE","ATTACHMENT_SEND","delete","ATTACHMENT_SEND_ALL","getAllAttachments","getState","toArray","getAttachment","getSelectedIndex"],"mappings":";;;;;;AAIA;;AACA;;;;AACA;;AACA;;;;;;;;;;+eAPA;;;;IASMA,gB;;;;;;;;;6BACJC,e,8BAAkB;AAChB,WAAO;AACLC,mBAAa,IAAI,oBAAUC,IAAd,EADR;AAELC,qBAAe;AAFV,KAAP;AAID,G;;6BAEDC,M,mBAAOC,K,EAAMC,M,EAAQ;AACnB,YAAQA,OAAOC,IAAf;AACE,WAAK,+BAAYC,qBAAjB;AACE,4BACKH,KADL;AAEEJ,uBAAa,IAAI,oBAAUC,IAAd,CAAmBI,OAAOL,WAA1B;AAFf;AAIF,WAAK,+BAAYQ,qBAAjB;AACE,eAAO,KAAKT,eAAL,EAAP;;AAEF,WAAK,+BAAYU,iBAAjB;AACE,4BACKL,KADL;AAEEF,yBAAeG,OAAOK;AAFxB;;AAKF,WAAK,+BAAYC,iBAAjB;AACE,YAAMC,oBAAoBR,MAAMJ,WAAN,CAAkBa,GAAlB,CAAsBT,MAAMF,aAA5B,CAA1B;;AAEA,4BACKE,KADL;AAEEJ,uBAAaI,MAAMJ,WAAN,CAAkBc,GAAlB,CAAsBV,MAAMF,aAA5B,eAAgDU,iBAAhD,IAAmEG,eAAeV,OAAOU,aAAzF;AAFf;;AAKF,WAAK,+BAAYC,iBAAjB;AACA,WAAK,+BAAYC,eAAjB;AACE,eAAO;AACLjB,uBAAaI,MAAMJ,WAAN,CAAkBkB,MAAlB,CAAyBd,MAAMF,aAA/B,CADR;AAELA,yBAAe;AAFV,SAAP;AAIF,WAAK,+BAAYiB,mBAAjB;AACE,eAAO,KAAKpB,eAAL,EAAP;;AAEF;AACE,eAAOK,KAAP;AAjCJ;AAmCD,G;;6BAEDgB,iB,gCAAoB;AAClB,WAAO,KAAKC,QAAL,GAAgBrB,WAAhB,CAA4BsB,OAA5B,EAAP;AACD,G;;6BAEDC,a,4BAA+C;AAAA,QAAjCb,KAAiC,uEAAzB,KAAKc,gBAAL,EAAyB;;AAC7C,WAAO,KAAKH,QAAL,GAAgBrB,WAAhB,CAA4Ba,GAA5B,CAAgCH,KAAhC,CAAP;AACD,G;;6BAEDc,gB,+BAAmB;AACjB,WAAO,KAAKH,QAAL,GAAgBnB,aAAvB;AACD,G;;;;;kBAGY,IAAIJ,gBAAJ,8B","file":"AttachmentsStore.js","sourcesContent":["/*\r\n * Copyright (C) 2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport { ReduceStore } from 'flux/utils';\r\nimport Dispatcher from '../dispatcher/ActorAppDispatcher';\r\nimport { ActionTypes } from '../constants/ActorAppConstants';\r\nimport Immutable from 'immutable';\r\n\r\nclass AttachmentsStore extends ReduceStore {\r\n  getInitialState() {\r\n    return {\r\n      attachments: new Immutable.List(),\r\n      selectedIndex: 0\r\n    }\r\n  }\r\n\r\n  reduce(state,action) {\r\n    switch (action.type) {\r\n      case ActionTypes.ATTACHMENT_MODAL_SHOW:\r\n        return {\r\n          ...state,\r\n          attachments: new Immutable.List(action.attachments)\r\n        }\r\n      case ActionTypes.ATTACHMENT_MODAL_HIDE:\r\n        return this.getInitialState();\r\n\r\n      case ActionTypes.ATTACHMENT_SELECT:\r\n        return {\r\n          ...state,\r\n          selectedIndex: action.index\r\n        }\r\n\r\n      case ActionTypes.ATTACHMENT_CHANGE:\r\n        const changedAttachment = state.attachments.get(state.selectedIndex);\r\n\r\n        return {\r\n          ...state,\r\n          attachments: state.attachments.set(state.selectedIndex, { ...changedAttachment, sendAsPicture: action.sendAsPicture })\r\n        };\r\n\r\n      case ActionTypes.ATTACHMENT_DELETE:\r\n      case ActionTypes.ATTACHMENT_SEND:\r\n        return {\r\n          attachments: state.attachments.delete(state.selectedIndex),\r\n          selectedIndex: 0\r\n        }\r\n      case ActionTypes.ATTACHMENT_SEND_ALL:\r\n        return this.getInitialState();\r\n\r\n      default:\r\n        return state;\r\n    }\r\n  }\r\n\r\n  getAllAttachments() {\r\n    return this.getState().attachments.toArray();\r\n  }\r\n\r\n  getAttachment(index = this.getSelectedIndex()) {\r\n    return this.getState().attachments.get(index);\r\n  }\r\n\r\n  getSelectedIndex() {\r\n    return this.getState().selectedIndex;\r\n  }\r\n}\r\n\r\nexport default new AttachmentsStore(Dispatcher);\r\n"]}