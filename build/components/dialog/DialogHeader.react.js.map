{"version":3,"sources":["../../../src/components/dialog/DialogHeader.react.js"],"names":["MAX_GROUP_CALL_SIZE","DialogHeader","props","context","state","isMoreDropdownOpen","onFavoriteToggle","bind","handleInfoButtonClick","handleMakeCallButtonClick","handleEndCallButtonClick","handleSearchButtonClick","toggelMoreDropdownOpen","handleAddPeople","peer","isFavorite","unfavoriteChat","favoriteChat","call","isActivityOpen","isCalling","toggleFloating","hide","show","makePeerCall","endCall","id","isDialogSearchOpen","open","close","info","setState","renderMessage","message","renderInfoButton","className","isFloating","renderVerified","isVerified","renderFavorite","favoriteClassName","renderSearchButton","delegate","features","search","callButtonClassName","renderCallButton","calls","type","GROUP","members","length","renderMoreDropdown","renderMoreButton","dropdownButtonClassNames","renderAddUsersButton","USER","render","avatar","placeholder","name","__html","contextTypes","object","isRequired","propTypes","string","bool"],"mappings":"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","file":"DialogHeader.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component, PropTypes } from 'react';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport classnames from 'classnames';\r\nimport Tooltip from 'rc-tooltip';\r\nimport { PeerTypes } from '../../constants/ActorAppConstants';\r\n\r\nimport { escapeWithEmoji } from '../../utils/EmojiUtils';\r\n\r\nimport CallActionCreators from '../../actions/CallActionCreators';\r\nimport ActivityActionCreators from '../../actions/ActivityActionCreators';\r\nimport FavoriteActionCreators from '../../actions/FavoriteActionCreators';\r\nimport SearchMessagesActionCreators from '../../actions/SearchMessagesActionCreators';\r\nimport InviteUserActions from '../../actions/InviteUserActions';\r\n\r\nimport AvatarItem from '../common/AvatarItem.react';\r\nimport ToggleFavorite from '../common/ToggleFavorite.react';\r\nimport MoreDropdown from './header/MoreDropdown.react';\r\nimport SmartCallButton from '../call/SmartCallButton.react';\r\n\r\nconst MAX_GROUP_CALL_SIZE = 25;\r\n\r\nclass DialogHeader extends Component {\r\n  static contextTypes = {\r\n    delegate: PropTypes.object.isRequired\r\n  }\r\n\r\n  static propTypes = {\r\n    peer: PropTypes.object.isRequired,\r\n    info: PropTypes.object.isRequired,\r\n    call: PropTypes.object.isRequired,\r\n    message: PropTypes.string,\r\n    isFavorite: PropTypes.bool.isRequired,\r\n    isActivityOpen: PropTypes.bool.isRequired,\r\n    isDialogSearchOpen: PropTypes.bool.isRequired\r\n  }\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n\r\n    this.state = {\r\n      isMoreDropdownOpen: false\r\n    }\r\n\r\n    this.onFavoriteToggle = this.onFavoriteToggle.bind(this);\r\n    this.handleInfoButtonClick = this.handleInfoButtonClick.bind(this);\r\n    this.handleMakeCallButtonClick = this.handleMakeCallButtonClick.bind(this);\r\n    this.handleEndCallButtonClick = this.handleEndCallButtonClick.bind(this);\r\n    this.handleSearchButtonClick = this.handleSearchButtonClick.bind(this);\r\n    this.toggelMoreDropdownOpen = this.toggelMoreDropdownOpen.bind(this);\r\n    this.handleAddPeople = this.handleAddPeople.bind(this);\r\n  }\r\n\r\n  onFavoriteToggle() {\r\n    const { peer, isFavorite } = this.props;\r\n\r\n    if (isFavorite) {\r\n      FavoriteActionCreators.unfavoriteChat(peer);\r\n    } else {\r\n      FavoriteActionCreators.favoriteChat(peer);\r\n    }\r\n  }\r\n\r\n  handleInfoButtonClick() {\r\n    const { call, isActivityOpen } = this.props;\r\n    if (call.isCalling) {\r\n      CallActionCreators.toggleFloating();\r\n    } else if (isActivityOpen) {\r\n      ActivityActionCreators.hide();\r\n    } else {\r\n      ActivityActionCreators.show();\r\n    }\r\n  }\r\n\r\n  handleMakeCallButtonClick() {\r\n    const { peer } = this.props;\r\n    CallActionCreators.makePeerCall(peer);\r\n  }\r\n\r\n  handleEndCallButtonClick() {\r\n    const { call } = this.props;\r\n    CallActionCreators.endCall(call.id);\r\n  }\r\n\r\n  handleSearchButtonClick() {\r\n    const { isDialogSearchOpen } = this.props;\r\n    if (!isDialogSearchOpen) {\r\n      SearchMessagesActionCreators.open();\r\n    } else {\r\n      SearchMessagesActionCreators.close();\r\n    }\r\n  }\r\n\r\n  handleAddPeople() {\r\n    const { info } = this.props;\r\n    InviteUserActions.show(info)\r\n  }\r\n\r\n  toggelMoreDropdownOpen() {\r\n    const { isMoreDropdownOpen } = this.state;\r\n    this.setState({ isMoreDropdownOpen: !isMoreDropdownOpen })\r\n  }\r\n\r\n  renderMessage() {\r\n    const { message } = this.props;\r\n\r\n    return message;\r\n  }\r\n\r\n  renderInfoButton() {\r\n    const { call, isActivityOpen } = this.props;\r\n\r\n    const className = classnames('button button--icon', {\r\n      'active': isActivityOpen || (call.isCalling && !call.isFloating)\r\n    });\r\n\r\n    return (\r\n      <Tooltip\r\n        placement=\"left\"\r\n        mouseEnterDelay={0}\r\n        mouseLeaveDelay={0}\r\n        overlay={<FormattedMessage id=\"tooltip.toolbar.info\"/>}\r\n      >\r\n        <button className={className} onClick={this.handleInfoButtonClick}>\r\n          <i className=\"material-icons\">info</i>\r\n        </button>\r\n      </Tooltip>\r\n    )\r\n  }\r\n\r\n  renderVerified() {\r\n    const { info } = this.props;\r\n\r\n    if (!info.isVerified) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <span className=\"dialog__header__peer__verified\">\r\n        <i className=\"material-icons\">verified_user</i>\r\n      </span>\r\n    );\r\n  }\r\n\r\n  renderFavorite() {\r\n    const { isFavorite } = this.props;\r\n    const favoriteClassName = classnames('dialog__header__peer__favorite', {\r\n      'dialog__header__peer__favorite--active': isFavorite\r\n    });\r\n\r\n    return (\r\n      <Tooltip\r\n        placement=\"bottom\"\r\n        mouseEnterDelay={0}\r\n        mouseLeaveDelay={0}\r\n        overlay={<FormattedMessage id=\"tooltip.toolbar.favorite\"/>}\r\n      >\r\n        <span className={favoriteClassName}>\r\n          <ToggleFavorite value={isFavorite} onToggle={this.onFavoriteToggle} />\r\n        </span>\r\n      </Tooltip>\r\n    )\r\n  }\r\n\r\n  renderSearchButton() {\r\n    const { delegate } = this.context;\r\n    const { isDialogSearchOpen } = this.props;\r\n\r\n    if (!delegate.features.search) {\r\n      return null;\r\n    }\r\n\r\n    const callButtonClassName = classnames('button button--icon', {\r\n      'active': isDialogSearchOpen\r\n    });\r\n\r\n    return (\r\n      <button className={callButtonClassName} onClick={this.handleSearchButtonClick}>\r\n        <i className=\"material-icons\">search</i>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  renderCallButton() {\r\n    const { delegate } = this.context;\r\n    const { peer, info } = this.props;\r\n\r\n    if (!delegate.features.calls) {\r\n      return null;\r\n    }\r\n\r\n    if (peer.type === PeerTypes.GROUP && info.members.length > MAX_GROUP_CALL_SIZE) {\r\n      return null;\r\n    }\r\n\r\n    const { call } = this.props;\r\n    return (\r\n      <SmartCallButton\r\n        call={call}\r\n        onCallStart={this.handleMakeCallButtonClick}\r\n        onCallEnd={this.handleEndCallButtonClick}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderMoreDropdown() {\r\n    const { isMoreDropdownOpen } = this.state;\r\n\r\n    if (!isMoreDropdownOpen) {\r\n      return null;\r\n    }\r\n\r\n    const { info, peer } = this.props;\r\n\r\n    return (\r\n      <MoreDropdown\r\n        onClose={this.toggelMoreDropdownOpen}\r\n        info={info}\r\n        peer={peer}\r\n      />\r\n    );\r\n  }\r\n\r\n  renderMoreButton() {\r\n    const { isMoreDropdownOpen } = this.state;\r\n\r\n    const dropdownButtonClassNames = classnames('button button--icon', {\r\n      'active': isMoreDropdownOpen\r\n    })\r\n\r\n    return (\r\n      <div className=\"dropdown dropdown--opened\">\r\n        <button className={dropdownButtonClassNames} onClick={this.toggelMoreDropdownOpen}>\r\n          <i className=\"material-icons\">more_vert</i>\r\n        </button>\r\n        {this.renderMoreDropdown()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderAddUsersButton() {\r\n    const { peer } = this.props;\r\n    if (peer.type === PeerTypes.USER) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <button className=\"button button--icon\" onClick={this.handleAddPeople}>\r\n        <i className=\"material-icons\">group_add</i>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { info } = this.props;\r\n\r\n    if (!info) {\r\n      return <header className=\"dialog__header\" />;\r\n    }\r\n\r\n    return (\r\n      <header className=\"dialog__header\">\r\n        <div className=\"row\">\r\n          <AvatarItem\r\n            className=\"dialog__header__avatar\"\r\n            size=\"medium\"\r\n            image={info.avatar}\r\n            placeholder={info.placeholder}\r\n            title={info.name}\r\n          />\r\n\r\n          <div className=\"dialog__header__peer\">\r\n            <header className=\"dialog__header__peer__title\" >\r\n              <span dangerouslySetInnerHTML={{ __html: escapeWithEmoji(info.name) }}/>\r\n              {this.renderVerified()}\r\n              {this.renderFavorite()}\r\n            </header>\r\n            <div className=\"dialog__header__peer__message\">\r\n              {this.renderMessage()}\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"col-xs\"/>\r\n\r\n          <div className=\"dialog__header__controls\">\r\n            {this.renderSearchButton()}\r\n            {this.renderCallButton()}\r\n            {this.renderAddUsersButton()}\r\n            {this.renderInfoButton()}\r\n            {this.renderMoreButton()}\r\n          </div>\r\n        </div>\r\n      </header>\r\n    );\r\n  }\r\n}\r\n\r\nexport default DialogHeader;\r\n"]}