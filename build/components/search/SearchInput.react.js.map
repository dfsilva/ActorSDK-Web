{"version":3,"sources":["../../../src/components/search/SearchInput.react.js"],"names":["SearchInput","props","handleFocus","bind","handleChange","handleKeyDown","handleGlobalClick","componentDidMount","listeners","listen","document","componentWillUnmount","forEach","listener","remove","event","isFocused","target","refs","search","onBlur","preventDefault","stopPropagation","onFocus","onChange","value","keyCode","K","metaKey","ctrlKey","focus","ESC","onClear","renderClear","render","intl","context","messages","activeElement","contextTypes","object","isRequired","propTypes","string","bool","func"],"mappings":"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","file":"SearchInput.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component, PropTypes } from 'react';\r\nimport EventListener from 'fbjs/lib/EventListener';\r\nimport { KeyCodes } from '../../constants/ActorAppConstants';\r\n\r\nclass SearchInput extends Component {\r\n  static contextTypes = {\r\n    intl: PropTypes.object.isRequired\r\n  };\r\n\r\n  static propTypes = {\r\n    value: PropTypes.string.isRequired,\r\n    isFocused: PropTypes.bool.isRequired,\r\n    onBlur: PropTypes.func.isRequired,\r\n    onFocus: PropTypes.func.isRequired,\r\n    onClear: PropTypes.func.isRequired,\r\n    onChange: PropTypes.func.isRequired\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.handleFocus = this.handleFocus.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    this.handleGlobalClick = this.handleGlobalClick.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.listeners = [\r\n      EventListener.listen(document, 'keydown', this.handleKeyDown),\r\n      EventListener.listen(document, 'click', this.handleGlobalClick)\r\n    ];\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.listeners.forEach((listener) => listener.remove());\r\n    this.listeners = null;\r\n  }\r\n\r\n  handleGlobalClick(event) {\r\n   if (this.props.isFocused && event.target !== this.refs.search) {\r\n     this.props.onBlur();\r\n   }\r\n }\r\n\r\n  handleFocus(event) {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    this.props.onFocus();\r\n  }\r\n\r\n  handleChange(event) {\r\n    this.props.onChange(event.target.value);\r\n  }\r\n\r\n  handleKeyDown(event) {\r\n    if (event.keyCode === KeyCodes.K && (event.metaKey || event.ctrlKey)) {\r\n      event.preventDefault();\r\n      this.focus();\r\n    }\r\n\r\n    if (event.keyCode === KeyCodes.ESC && this.isFocused()) {\r\n      event.preventDefault();\r\n      this.props.onClear();\r\n    }\r\n  }\r\n\r\n  renderClear() {\r\n    if (!this.props.value) {\r\n      return null;\r\n    }\r\n\r\n    return (\r\n      <i className=\"close-icon material-icons\" onClick={this.props.onClear}>close</i>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const { value } = this.props;\r\n    const { intl } = this.context;\r\n\r\n    return (\r\n      <div className=\"row toolbar__search__input col-xs\">\r\n        <input\r\n          className=\"input input--search col-xs\"\r\n          type=\"search\"\r\n          ref=\"search\"\r\n          tabIndex=\"1\"\r\n          value={value}\r\n          placeholder={intl.messages['search.placeholder']}\r\n          onFocus={this.props.onFocus}\r\n          onChange={this.handleChange}\r\n        />\r\n        {this.renderClear()}\r\n      </div>\r\n    );\r\n  }\r\n\r\n  focus() {\r\n    if (this.refs.search) {\r\n      this.refs.search.focus();\r\n    }\r\n  }\r\n\r\n  isFocused() {\r\n    return document.activeElement === this.refs.search;\r\n  }\r\n}\r\n\r\nexport default SearchInput;\r\n"]}