{"version":3,"sources":["../../src/components/Login.react.js"],"names":["Login","props","onLoginChange","event","preventDefault","changeLogin","target","value","onCodeChange","changeCode","onNameChange","changeName","onRequestCode","requestCode","state","login","onSendCode","sendCode","code","onSignupRequested","sendSignup","name","handleRestartAuthClick","restartAuth","toogleLoginType","handleFocus","step","LOGIN_WAIT","refs","focus","CODE_WAIT","NAME_WAIT","SharedActor","get","appName","start","getStores","calculateState","getLogin","getCode","getName","getStep","errors","getErrors","isCodeRequested","isCodeSended","isSignupStarted","loginType","getLoginType","componentDidMount","componentDidUpdate","render","intl","context","hiddenStyle","display","requestFormClassName","checkFormClassName","signupFormClassName","spinner","messages","COMPLETED","signup","contextTypes","object","create","pure","withProps"],"mappings":"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","file":"Login.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component, PropTypes } from 'react';\r\nimport { Container } from 'flux/utils';\r\nimport classnames from 'classnames';\r\nimport SharedContainer from '../utils/SharedContainer';\r\nimport { appName, AuthSteps } from '../constants/ActorAppConstants';\r\nimport { FormattedMessage, FormattedHTMLMessage } from 'react-intl';\r\n\r\nimport LoginActionCreators from '../actions/LoginActionCreators';\r\n\r\nimport LoginStore from '../stores/LoginStore';\r\n\r\nimport TextField from './common/TextField.react';\r\n\r\nclass Login extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    const SharedActor = SharedContainer.get();\r\n    this.appName = SharedActor.appName ? SharedActor.appName : appName;\r\n\r\n    LoginActionCreators.start();\r\n  }\r\n\r\n  static getStores() {\r\n    return [LoginStore];\r\n  }\r\n\r\n  static calculateState() {\r\n    return {\r\n      login: LoginStore.getLogin(),\r\n      code: LoginStore.getCode(),\r\n      name: LoginStore.getName(),\r\n      step: LoginStore.getStep(),\r\n      errors: LoginStore.getErrors(),\r\n      isCodeRequested: LoginStore.isCodeRequested(),\r\n      isCodeSended: LoginStore.isCodeSended(),\r\n      isSignupStarted: LoginStore.isSignupStarted(),\r\n      loginType : LoginStore.getLoginType()\r\n    }\r\n  }\r\n\r\n  static contextTypes = {\r\n    intl: PropTypes.object\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.handleFocus();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.handleFocus();\r\n  }\r\n\r\n  // From change handlers\r\n  onLoginChange = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.changeLogin(event.target.value);\r\n  };\r\n  onCodeChange = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.changeCode(event.target.value);\r\n  };\r\n  onNameChange = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.changeName(event.target.value);\r\n  };\r\n\r\n  // Form submit handlers\r\n  onRequestCode = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.requestCode(this.state.login);\r\n  };\r\n  onSendCode = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.sendCode(this.state.code);\r\n  };\r\n  onSignupRequested = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.sendSignup(this.state.name);\r\n  };\r\n\r\n  handleRestartAuthClick = event => {\r\n    event.preventDefault();\r\n    LoginActionCreators.restartAuth();\r\n  };\r\n\r\n  toogleLoginType = () => {\r\n    LoginActionCreators.toogleLoginType();\r\n  };\r\n\r\n  handleFocus = () => {\r\n    const { step } = this.state;\r\n\r\n    switch (step) {\r\n      case AuthSteps.LOGIN_WAIT:\r\n        this.refs.login.focus();\r\n        break;\r\n      case AuthSteps.CODE_WAIT:\r\n        this.refs.code.focus();\r\n        break;\r\n      case AuthSteps.NAME_WAIT:\r\n        this.refs.name.focus();\r\n        break;\r\n      default:\r\n    }\r\n  };\r\n\r\n  render() {\r\n    const { step, errors, login, code, name, isCodeRequested, isCodeSended, isSignupStarted, loginType } = this.state;\r\n    const { intl } = this.context;\r\n\r\n    const hiddenStyle = {\r\n        display: 'none'\r\n    };\r\n\r\n    let requestFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--request', {\r\n      'login-new__forms__form--active': step === AuthSteps.LOGIN_WAIT,\r\n      'login-new__forms__form--done': step !== AuthSteps.LOGIN_WAIT && isCodeRequested\r\n    });\r\n    let checkFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--check', {\r\n      'login-new__forms__form--active': step === AuthSteps.CODE_WAIT && isCodeRequested,\r\n      'login-new__forms__form--done': step !== AuthSteps.CODE_WAIT && isCodeSended\r\n    });\r\n    let signupFormClassName = classnames('login-new__forms__form', 'login-new__forms__form--signup', {\r\n      'login-new__forms__form--active': step === AuthSteps.NAME_WAIT\r\n    });\r\n\r\n    const spinner = (\r\n      <div className=\"spinner\">\r\n        <div/><div/><div/><div/><div/><div/>\r\n        <div/><div/><div/><div/><div/><div/>\r\n      </div>\r\n    );\r\n\r\n    return (\r\n      <section className=\"login-new row center-xs middle-xs\">\r\n        <div className=\"login-new__welcome col-xs row center-xs middle-xs\">\r\n          <img alt={`${this.appName} messenger`}\r\n               className=\"logo\"\r\n               src=\"assets/images/logo.png\"\r\n               srcSet=\"assets/images/logo@2x.png 2x\"/>\r\n\r\n          <article>\r\n            <h1 className=\"login-new__heading\">\r\n              <FormattedHTMLMessage id=\"login.welcome.header\" values={{ appName: this.appName }}/>\r\n            </h1>\r\n\r\n            <FormattedHTMLMessage id=\"login.welcome.text\" values={{ appName: this.appName }}/>\r\n          </article>\r\n\r\n          <footer>\r\n            <div className=\"pull-left\"><FormattedMessage id=\"login.welcome.copyright\" values={{ appName: this.appName }}/></div>\r\n            <div className=\"pull-right\">\r\n              <a href=\"//itunes.apple.com/us/app/conecta-im/id1347857436?ls=1&mt=8\">iPhone</a>&nbsp;&nbsp;•&nbsp;&nbsp;\r\n              <a href=\"//play.google.com/store/apps/details?id=br.com.diegosilva.conecta\">Android</a>\r\n            </div>\r\n          </footer>\r\n        </div>\r\n\r\n        <div className=\"login-new__forms col-xs-6 col-md-4 row center-xs middle-xs\">\r\n          <div>\r\n            <h1 className=\"login-new__heading\"><FormattedMessage id=\"login.signIn\"/></h1>\r\n\r\n            <form className={requestFormClassName} onSubmit={this.onRequestCode}>\r\n              <a className=\"wrong\" onClick={this.handleRestartAuthClick}><FormattedMessage id=\"login.wrong\"/></a>\r\n\r\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\r\n                         disabled={isCodeRequested || step !== AuthSteps.LOGIN_WAIT}\r\n                         errorText={errors.login}\r\n                         type={loginType == 0 ? 'text' : loginType == 1 ? 'phone' : 'email'}\r\n                         floatingLabel={loginType == 0 ? intl.messages['login.phone_or_email'] : loginType == 1 ? intl.messages['login.phone'] : intl.messages['login.email']}\r\n                         onChange={this.onLoginChange}\r\n                         ref=\"login\"\r\n                         value={login}/>\r\n\r\n              <footer className=\"text-center\">\r\n                <button className=\"button button--rised button--wide\"\r\n                        type=\"submit\"\r\n                        disabled={isCodeRequested}>\r\n                  <FormattedMessage id=\"button.requestCode\"/>\r\n                  {isCodeRequested ? spinner : null}\r\n                </button>\r\n                <button type=\"button\" style={hiddenStyle}\r\n                        onClick={this.toogleLoginType}>Change Login Type</button>\r\n              </footer>\r\n            </form>\r\n            <form className={checkFormClassName} onSubmit={this.onSendCode}>\r\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\r\n                         disabled={isCodeSended || step !== AuthSteps.CODE_WAIT}\r\n                         errorText={errors.code}\r\n                         floatingLabel={intl.messages['login.authCode']}\r\n                         onChange={this.onCodeChange}\r\n                         ref=\"code\"\r\n                         type=\"text\"\r\n                         value={code}/>\r\n              <footer className=\"text-center\">\r\n                <button className=\"button button--rised button--wide\"\r\n                        type=\"submit\"\r\n                        disabled={isCodeSended}>\r\n                  <FormattedMessage id=\"button.checkCode\"/>\r\n                  {isCodeSended ? spinner : null}\r\n                </button>\r\n              </footer>\r\n            </form>\r\n\r\n            <form className={signupFormClassName} onSubmit={this.onSignupRequested}>\r\n              <TextField className=\"login-new__forms__form__input input__material--wide\"\r\n                         disabled={isSignupStarted || step === AuthSteps.COMPLETED}\r\n                         errorText={errors.signup}\r\n                         floatingLabel={intl.messages['login.yourName']}\r\n                         onChange={this.onNameChange}\r\n                         ref=\"name\"\r\n                         type=\"text\"\r\n                         value={name}/>\r\n              <footer className=\"text-center\">\r\n                <button className=\"button button--rised button--wide\"\r\n                        type=\"submit\"\r\n                        disabled={isSignupStarted}>\r\n                  <FormattedMessage id=\"button.signUp\"/>\r\n                  {isSignupStarted ? spinner : null}\r\n                </button>\r\n              </footer>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Container.create(Login, { pure: false, withProps: true });\r\n"]}