{"version":3,"sources":["../../../src/components/modals/Attachments.react.js"],"names":["Attachments","getStores","calculateState","attachments","getAllAttachments","selectedIndex","getSelectedIndex","props","handleClose","bind","handleKeyDown","handleSelect","handleCancel","handleSend","handleSendAll","componentWillMount","document","addEventListener","componentDidMount","refs","send","focus","componentWillUnmount","removeEventListener","hide","event","keyCode","ENTER","preventDefault","shiftKey","index","selectAttachment","deleteAttachment","sendAttachment","sendAll","state","renderHeaderButton","length","renderAttachment","renderPagination","renderControls","render","create"],"mappings":"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","file":"Attachments.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component } from 'react';\r\nimport { Container } from 'flux/utils';\r\nimport { findDOMNode } from 'react-dom';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport Modal from 'react-modal';\r\n\r\nimport { KeyCodes } from '../../constants/ActorAppConstants';\r\n\r\nimport AttachmentsActionCreators from '../../actions/AttachmentsActionCreators';\r\n\r\nimport AttachmentsStore from '../../stores/AttachmentsStore';\r\n\r\nimport Attachment from './attachments/Attachment.react';\r\nimport Pagination from './attachments/Pagination.react';\r\n\r\nclass Attachments extends Component {\r\n  static getStores() {\r\n    return [AttachmentsStore];\r\n  }\r\n\r\n  static calculateState() {\r\n    return {\r\n      attachments: AttachmentsStore.getAllAttachments(),\r\n      selectedIndex: AttachmentsStore.getSelectedIndex()\r\n    }\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.handleClose = this.handleClose.bind(this);\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    this.handleSelect = this.handleSelect.bind(this);\r\n    this.handleCancel = this.handleCancel.bind(this);\r\n    this.handleSend = this.handleSend.bind(this);\r\n    this.handleSendAll = this.handleSendAll.bind(this);\r\n  }\r\n\r\n  componentWillMount() {\r\n    document.addEventListener('keydown', this.handleKeyDown, false);\r\n  }\r\n\r\n  componentDidMount() {\r\n    findDOMNode(this.refs.send).focus()\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener('keydown', this.handleKeyDown, false);\r\n  }\r\n\r\n  handleClose() {\r\n    AttachmentsActionCreators.hide();\r\n  }\r\n\r\n  handleKeyDown(event) {\r\n    if (event.keyCode === KeyCodes.ENTER) {\r\n      event.preventDefault();\r\n      if (event.shiftKey) {\r\n        this.handleSendAll();\r\n      } else {\r\n        this.handleSend();\r\n      }\r\n    }\r\n  }\r\n\r\n  handleSelect(index) {\r\n    AttachmentsActionCreators.selectAttachment(index);\r\n  }\r\n\r\n  handleCancel() {\r\n    AttachmentsActionCreators.deleteAttachment();\r\n  }\r\n\r\n  handleSend() {\r\n    AttachmentsActionCreators.sendAttachment();\r\n  }\r\n\r\n  handleSendAll() {\r\n    AttachmentsActionCreators.sendAll(this.state.attachments);\r\n  }\r\n\r\n  renderHeaderButton() {\r\n    const { attachments } = this.state;\r\n    if (attachments.length <= 1) return null;\r\n\r\n    return (\r\n      <button className=\"button button--lightblue\" onClick={this.handleSendAll}>\r\n        <FormattedMessage id=\"button.sendAll\"/>\r\n      </button>\r\n    );\r\n  }\r\n\r\n  renderAttachment() {\r\n    const { attachments, selectedIndex } = this.state;\r\n    if (attachments.length === 0) return null;\r\n\r\n    return (\r\n      <Attachment attachment={attachments[selectedIndex]}/>\r\n    );\r\n  }\r\n\r\n  renderPagination() {\r\n    const { attachments, selectedIndex } = this.state;\r\n    if (attachments.length <= 1) return null;\r\n\r\n    return (\r\n      <div className=\"col-xs\">\r\n        <Pagination\r\n          current={selectedIndex}\r\n          total={attachments.length - 1}\r\n          onChange={this.handleSelect}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderControls() {\r\n    return (\r\n      <div className=\"col-xs text-right\">\r\n        <button className=\"button\" onClick={this.handleCancel}>\r\n          <FormattedMessage id=\"button.cancel\"/>\r\n        </button>\r\n        <button className=\"button button--rised\" ref=\"send\" onClick={this.handleSend}>\r\n          <FormattedMessage id=\"button.send\"/>\r\n        </button>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        overlayClassName=\"modal-overlay\"\r\n        className=\"modal\"\r\n        onRequestClose={this.handleClose}\r\n        isOpen>\r\n\r\n        <div className=\"attachments\">\r\n          <div className=\"modal__content\">\r\n\r\n            <header className=\"modal__header\">\r\n              <FormattedMessage id=\"modal.attachments.title\" tagName=\"h1\"/>\r\n              {this.renderHeaderButton()}\r\n            </header>\r\n\r\n            <div className=\"modal__body\">\r\n              {this.renderAttachment()}\r\n            </div>\r\n\r\n            <footer className=\"modal__footer row\">\r\n              {this.renderPagination()}\r\n              {this.renderControls()}\r\n            </footer>\r\n\r\n          </div>\r\n        </div>\r\n\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Container.create(Attachments);\r\n"]}