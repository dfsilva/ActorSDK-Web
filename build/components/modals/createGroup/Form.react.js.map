{"version":3,"sources":["../../../../src/components/modals/createGroup/Form.react.js"],"names":["CreateGroupForm","getStores","calculateState","step","getCurrentStep","name","getGroupName","selectedUserIds","getSelectedUserIds","contacts","getState","props","context","onContactToggle","bind","handleNameChange","handleNameSubmit","handleCreateGroup","onSearchChange","componentDidMount","state","NAME_INPUT","refs","focus","getContacts","search","filter","key","renderContacts","length","map","contact","i","isSelected","has","uid","icon","setSelectedUserIds","add","remove","event","preventDefault","setState","target","value","trimmedName","trim","setGroupName","createGroup","toJS","renderGroupNameInput","renderAddUsersButton","renderUserSearchInput","intl","messages","renderSelectedUsersCount","numMembers","size","renderCreateGroupButton","CREATION_STARTED","render","CONTACTS_SELECTION","contextTypes","object","create","pure"],"mappings":";;;;;;AAIA;;;;AACA;;AACA;;AACA;;;;AACA;;AAEA;;;;AAEA;;;;AACA;;;;AAEA;;;;AACA;;;;;;;;;;+eAhBA;;;;IAkBMA,e;;;kBAKGC,S,wBAAY;AACjB,WAAO,mDAAP;AACD,G;;kBAEMC,c,6BAAiB;AACtB,WAAO;AACLC,YAAM,2BAAiBC,cAAjB,EADD;AAELC,YAAM,2BAAiBC,YAAjB,EAFD;AAGLC,uBAAiB,2BAAiBC,kBAAjB,EAHZ;AAILC,gBAAU,sBAAYC,QAAZ;AAJL,KAAP;AAMD,G;;AAED,2BAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA,iDAC1B,sBAAMD,KAAN,EAAaC,OAAb,CAD0B;;AAG1B,UAAKC,eAAL,GAAuB,MAAKA,eAAL,CAAqBC,IAArB,OAAvB;AACA,UAAKC,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBD,IAAtB,OAAxB;AACA,UAAKE,gBAAL,GAAwB,MAAKA,gBAAL,CAAsBF,IAAtB,OAAxB;AACA,UAAKG,iBAAL,GAAyB,MAAKA,iBAAL,CAAuBH,IAAvB,OAAzB;AACA,UAAKI,cAAL,GAAsB,MAAKA,cAAL,CAAoBJ,IAApB,OAAtB;AAP0B;AAQ3B;;4BAEDK,iB,gCAAoB;AAClB,QAAI,KAAKC,KAAL,CAAWjB,IAAX,KAAoB,oCAAiBkB,UAAzC,EAAqD;AACnD,WAAKC,IAAL,CAAUjB,IAAV,CAAekB,KAAf;AACD;AACF,G;;4BAEDC,W,0BAAc;AAAA,iBACiB,KAAKJ,KADtB;AAAA,QACJX,QADI,UACJA,QADI;AAAA,QACMgB,MADN,UACMA,MADN;;;AAGZ,WAAO,qBAAWC,MAAX,CAAkBjB,QAAlB,EAA4BgB,MAA5B,EAAoC;AACzCE,WAAK;AADoC,KAApC,CAAP;AAGD,G;;4BAEDC,c,6BAAiB;AAAA;;AAAA,QACPrB,eADO,GACa,KAAKa,KADlB,CACPb,eADO;;AAEf,QAAME,WAAW,KAAKe,WAAL,EAAjB;;AAEA,QAAI,CAACf,SAASoB,MAAd,EAAsB;AACpB,aACE;AAAA;AAAA,UAAI,WAAU,8DAAd;AACE,qEAAkB,IAAG,iBAArB;AADF,OADF;AAKD;;AAED,WAAOpB,SAASqB,GAAT,CAAa,UAACC,OAAD,EAAUC,CAAV,EAAgB;AAClC,UAAMC,aAAa1B,gBAAgB2B,GAAhB,CAAoBH,QAAQI,GAA5B,CAAnB;AACA,UAAMC,OAAOH,aAAa,WAAb,GAA2B,yBAAxC;;AAEA,aACE;AAAA;AAAA,qBAAiBF,OAAjB,IAA0B,KAAKC,CAA/B;AACE;AAAA;AAAA,YAAG,WAAU,gBAAb,EAA8B,SAAS;AAAA,qBAAM,OAAKnB,eAAL,CAAqBkB,OAArB,EAA8B,CAACE,UAA/B,CAAN;AAAA,aAAvC;AACGG;AADH;AADF,OADF;AAOD,KAXM,CAAP;AAYD,G;;4BAEDvB,e,4BAAgBkB,O,EAASE,U,EAAY;AAAA,QAC3B1B,eAD2B,GACP,KAAKa,KADE,CAC3Bb,eAD2B;;;AAGnC,QAAI0B,UAAJ,EAAgB;AACd,0CAA0BI,kBAA1B,CAA6C9B,gBAAgB+B,GAAhB,CAAoBP,QAAQI,GAA5B,CAA7C;AACD,KAFD,MAEO;AACL,0CAA0BE,kBAA1B,CAA6C9B,gBAAgBgC,MAAhB,CAAuBR,QAAQI,GAA/B,CAA7C;AACD;AACF,G;;4BAEDpB,gB,6BAAiByB,K,EAAO;AACtBA,UAAMC,cAAN;;AAEA,SAAKC,QAAL,CAAc,EAAErC,MAAMmC,MAAMG,MAAN,CAAaC,KAArB,EAAd;AACD,G;;4BAED5B,gB,6BAAiBwB,K,EAAO;AACtBA,UAAMC,cAAN;;AADsB,QAGdpC,IAHc,GAGL,KAAKe,KAHA,CAGdf,IAHc;;AAItB,QAAMwC,cAAcxC,KAAKyC,IAAL,EAApB;;AAEA,QAAID,YAAYhB,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,0CAA0BkB,YAA1B,CAAuCF,WAAvC;AACD;AACF,G;;4BAED5B,iB,8BAAkBuB,K,EAAO;AACvBA,UAAMC,cAAN;AADuB,kBAEW,KAAKrB,KAFhB;AAAA,QAEff,IAFe,WAEfA,IAFe;AAAA,QAETE,eAFS,WAETA,eAFS;;;AAIvB,wCAA0ByC,WAA1B,CAAsC3C,IAAtC,EAA4C,IAA5C,EAAkDE,gBAAgB0C,IAAhB,EAAlD;AACD,G;;4BAED/B,c,2BAAesB,K,EAAO;AACpB,SAAKE,QAAL,CAAc,EAAEjB,QAAQe,MAAMG,MAAN,CAAaC,KAAvB,EAAd;AACD,G;;4BAEDM,oB,mCAAuB;AAAA,QACb7C,IADa,GACJ,KAAKe,KADD,CACbf,IADa;;AAErB,WACE;AACE,iBAAU,uBADZ;AAEE,qBAAe,6DAAkB,IAAG,6BAArB,GAFjB;AAGE,WAAI,MAHN;AAIE,gBAAU,KAAKU,gBAJjB;AAKE,aAAOV,IALT,GADF;AAQD,G;;4BAED8C,oB,mCAAuB;AACrB,WACE;AAAA;AAAA,QAAQ,WAAU,0BAAlB,EAA6C,SAAS,KAAKnC,gBAA3D;AACE,mEAAkB,IAAG,mBAArB;AADF,KADF;AAKD,G;;4BAEDoC,qB,oCAAwB;AAAA,QACd3B,MADc,GACH,KAAKL,KADF,CACdK,MADc;AAAA,QAEd4B,IAFc,GAEL,KAAKzC,OAFA,CAEdyC,IAFc;;;AAItB,WACE;AAAA;AAAA,QAAK,WAAU,cAAf;AACE;AAAA;AAAA,UAAG,WAAU,gBAAb;AAAA;AAAA,OADF;AAEE;AACE,mBAAU,OADZ;AAEE,kBAAU,KAAKnC,cAFjB;AAGE,qBAAamC,KAAKC,QAAL,CAAc,eAAd,CAHf;AAIE,cAAK,QAJP;AAKE,eAAO7B,MALT;AAFF,KADF;AAWD,G;;4BAED8B,wB,uCAA2B;AAAA,QACjBhD,eADiB,GACG,KAAKa,KADR,CACjBb,eADiB;;AAEzB,WACE;AAAA;AAAA,QAAK,WAAU,OAAf;AACE,mEAAkB,IAAG,SAArB,EAA+B,QAAQ,EAAEiD,YAAYjD,gBAAgBkD,IAA9B,EAAvC;AADF,KADF;AAKD,G;;4BAEDC,uB,sCAA0B;AAAA,QAChBvD,IADgB,GACP,KAAKiB,KADE,CAChBjB,IADgB;;;AAGxB,QAAIA,SAAS,oCAAiBwD,gBAA9B,EAAgD;AAC9C,aACE;AAAA;AAAA,UAAQ,WAAU,0BAAlB,EAA6C,SAAS,KAAK1C,iBAA3D;AACE,qEAAkB,IAAG,oBAArB;AADF,OADF;AAKD;;AAED,WACE;AAAA;AAAA,QAAQ,WAAU,0BAAlB,EAA6C,cAA7C;AACE,mEAAkB,IAAG,oBAArB;AADF,KADF;AAKD,G;;4BAED2C,M,qBAAS;AAAA,QACCzD,IADD,GACU,KAAKiB,KADf,CACCjB,IADD;;;AAGP,YAAQA,IAAR;AACE,WAAK,oCAAiBkB,UAAtB;AACE,eACE;AAAA;AAAA,YAAM,WAAU,YAAhB;AACE;AAAA;AAAA,cAAK,WAAU,aAAf;AACG,iBAAK6B,oBAAL;AADH,WADF;AAKE;AAAA;AAAA,cAAQ,WAAU,0BAAlB;AACG,iBAAKC,oBAAL;AADH;AALF,SADF;;AAYF,WAAK,oCAAiBU,kBAAtB;AACA,WAAK,oCAAiBF,gBAAtB;AACE,eACE;AAAA;AAAA,YAAM,WAAU,eAAhB;AACE;AAAA;AAAA,cAAK,WAAU,aAAf;AACG,iBAAKP,qBAAL,EADH;AAGE;AAAA;AAAA,gBAAI,WAAU,gBAAd;AACG,mBAAKxB,cAAL;AADH;AAHF,WADF;AASE;AAAA;AAAA,cAAQ,WAAU,eAAlB;AACE;AAAA;AAAA,gBAAK,WAAU,KAAf;AACE;AAAA;AAAA,kBAAK,WAAU,kBAAf;AACG,qBAAK2B,wBAAL;AADH,eADF;AAIE;AAAA;AAAA,kBAAK,WAAU,mBAAf;AACG,qBAAKG,uBAAL;AADH;AAJF;AADF;AATF,SADF;AAsBF;AACE,eAAO,IAAP;AAvCJ;AAyCD,G;;;;;AAtNG1D,e,CACG8D,Y,GAAe;AACpBT,QAAM,iBAAUU;AADI,C;kBAwNT,iBAAUC,MAAV,CAAiBhE,eAAjB,EAAkC,EAAEiE,MAAM,KAAR,EAAlC,C","file":"Form.react.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport React, { Component, PropTypes } from 'react';\nimport { Container } from 'flux/utils';\nimport { FormattedMessage } from 'react-intl';\nimport fuzzaldrin from 'fuzzaldrin';\nimport { CreateGroupSteps } from '../../../constants/ActorAppConstants';\n\nimport CreateGroupActionCreators from '../../../actions/CreateGroupActionCreators';\n\nimport PeopleStore from '../../../stores/PeopleStore';\nimport CreateGroupStore from '../../../stores/CreateGroupStore';\n\nimport ContactItem from '../../common/ContactItem.react';\nimport TextField from '../../common/TextField.react';\n\nclass CreateGroupForm extends Component {\n  static contextTypes = {\n    intl: PropTypes.object\n  };\n\n  static getStores() {\n    return [CreateGroupStore, PeopleStore];\n  }\n\n  static calculateState() {\n    return {\n      step: CreateGroupStore.getCurrentStep(),\n      name: CreateGroupStore.getGroupName(),\n      selectedUserIds: CreateGroupStore.getSelectedUserIds(),\n      contacts: PeopleStore.getState()\n    };\n  }\n\n  constructor(props, context) {\n    super(props, context);\n\n    this.onContactToggle = this.onContactToggle.bind(this);\n    this.handleNameChange = this.handleNameChange.bind(this);\n    this.handleNameSubmit = this.handleNameSubmit.bind(this);\n    this.handleCreateGroup = this.handleCreateGroup.bind(this);\n    this.onSearchChange = this.onSearchChange.bind(this);\n  }\n\n  componentDidMount() {\n    if (this.state.step === CreateGroupSteps.NAME_INPUT) {\n      this.refs.name.focus();\n    }\n  }\n\n  getContacts() {\n    const { contacts, search } = this.state;\n\n    return fuzzaldrin.filter(contacts, search, {\n      key: 'name'\n    });\n  }\n\n  renderContacts() {\n    const { selectedUserIds } = this.state;\n    const contacts = this.getContacts();\n\n    if (!contacts.length) {\n      return (\n        <li className=\"contacts__list__item contacts__list__item--empty text-center\">\n          <FormattedMessage id=\"invite.notFound\"/>\n        </li>\n      );\n    }\n\n    return contacts.map((contact, i) => {\n      const isSelected = selectedUserIds.has(contact.uid);\n      const icon = isSelected ? 'check_box' : 'check_box_outline_blank';\n\n      return (\n        <ContactItem {...contact} key={i}>\n          <a className=\"material-icons\" onClick={() => this.onContactToggle(contact, !isSelected)}>\n            {icon}\n          </a>\n        </ContactItem>\n      );\n    });\n  }\n\n  onContactToggle(contact, isSelected) {\n    const { selectedUserIds } = this.state;\n\n    if (isSelected) {\n      CreateGroupActionCreators.setSelectedUserIds(selectedUserIds.add(contact.uid));\n    } else {\n      CreateGroupActionCreators.setSelectedUserIds(selectedUserIds.remove(contact.uid));\n    }\n  }\n\n  handleNameChange(event) {\n    event.preventDefault();\n\n    this.setState({ name: event.target.value });\n  }\n\n  handleNameSubmit(event) {\n    event.preventDefault();\n\n    const { name } = this.state;\n    const trimmedName = name.trim();\n\n    if (trimmedName.length > 0) {\n      CreateGroupActionCreators.setGroupName(trimmedName);\n    }\n  }\n\n  handleCreateGroup(event) {\n    event.preventDefault();\n    const { name, selectedUserIds } = this.state;\n\n    CreateGroupActionCreators.createGroup(name, null, selectedUserIds.toJS());\n  }\n\n  onSearchChange(event) {\n    this.setState({ search: event.target.value });\n  }\n\n  renderGroupNameInput() {\n    const { name } = this.state;\n    return (\n      <TextField\n        className=\"input__material--wide\"\n        floatingLabel={<FormattedMessage id=\"modal.createGroup.groupName\"/>}\n        ref=\"name\"\n        onChange={this.handleNameChange}\n        value={name}/>\n    );\n  }\n\n  renderAddUsersButton() {\n    return (\n      <button className=\"button button--lightblue\" onClick={this.handleNameSubmit}>\n        <FormattedMessage id=\"button.addMembers\"/>\n      </button>\n    );\n  }\n\n  renderUserSearchInput() {\n    const { search } = this.state;\n    const { intl } = this.context;\n\n    return (\n      <div className=\"small-search\">\n        <i className=\"material-icons\">search</i>\n        <input\n          className=\"input\"\n          onChange={this.onSearchChange}\n          placeholder={intl.messages['invite.search']}\n          type=\"search\"\n          value={search}/>\n      </div>\n    );\n  }\n\n  renderSelectedUsersCount() {\n    const { selectedUserIds } = this.state;\n    return (\n      <div className=\"count\">\n        <FormattedMessage id=\"members\" values={{ numMembers: selectedUserIds.size }}/>\n      </div>\n    );\n  }\n\n  renderCreateGroupButton() {\n    const { step } = this.state;\n\n    if (step !== CreateGroupSteps.CREATION_STARTED) {\n      return (\n        <button className=\"button button--lightblue\" onClick={this.handleCreateGroup}>\n          <FormattedMessage id=\"button.createGroup\"/>\n        </button>\n      )\n    }\n\n    return (\n      <button className=\"button button--lightblue\" disabled>\n        <FormattedMessage id=\"button.createGroup\"/>\n      </button>\n    );\n  }\n\n  render() {\n    const { step } = this.state;\n\n    switch (step) {\n      case CreateGroupSteps.NAME_INPUT:\n        return (\n          <form className=\"group-name\">\n            <div className=\"modal__body\">\n              {this.renderGroupNameInput()}\n            </div>\n\n            <footer className=\"modal__footer text-right\">\n              {this.renderAddUsersButton()}\n            </footer>\n          </form>\n        );\n\n      case CreateGroupSteps.CONTACTS_SELECTION:\n      case CreateGroupSteps.CREATION_STARTED:\n        return (\n          <form className=\"group-members\">\n            <div className=\"modal__body\">\n              {this.renderUserSearchInput()}\n\n              <ul className=\"contacts__list\">\n                {this.renderContacts()}\n              </ul>\n            </div>\n\n            <footer className=\"modal__footer\">\n              <div className=\"row\">\n                <div className=\"col-xs text-left\">\n                  {this.renderSelectedUsersCount()}\n                </div>\n                <div className=\"col-xs text-right\">\n                  {this.renderCreateGroupButton()}\n                </div>\n              </div>\n            </footer>\n          </form>\n        );\n      default:\n        return null;\n    }\n  }\n}\n\nexport default Container.create(CreateGroupForm, { pure: false });\n"]}