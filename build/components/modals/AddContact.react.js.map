{"version":3,"sources":["../../../src/components/modals/AddContact.react.js"],"names":["AddContact","getStores","calculateState","results","getResults","isSearching","props","context","handleClose","bind","handleQueryChange","findUsers","trailing","addContact","handleKeyDown","handleSelect","componentWillMount","document","addEventListener","componentDidMount","refs","query","focus","componentWillUnmount","removeEventListener","close","event","target","value","setState","state","keyCode","ENTER","preventDefault","uid","isContact","addToContacts","renderUserSearchInput","renderUserSearchResults","length","map","result","index","render","contextTypes","intl","object","create"],"mappings":"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","file":"AddContact.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport { debounce } from 'lodash';\r\nimport React, { Component, PropTypes } from 'react';\r\nimport { Container } from 'flux/utils';\r\nimport Modal from 'react-modal';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { KeyCodes } from '../../constants/ActorAppConstants';\r\n\r\nimport AddContactActionCreators from '../../actions/AddContactActionCreators';\r\n\r\nimport AddContactStore from '../../stores/AddContactStore';\r\n\r\nimport TextField from '../common/TextField.react';\r\nimport ContactItem from './addContact/ContactItem.react';\r\n\r\nclass AddContact extends Component {\r\n  static getStores() {\r\n    return [AddContactStore];\r\n  }\r\n\r\n  static calculateState() {\r\n    return {\r\n      results: AddContactStore.getResults(),\r\n      isSearching: AddContactStore.isSearching()\r\n    };\r\n  }\r\n\r\n  static contextTypes = {\r\n    intl: PropTypes.object\r\n  };\r\n\r\n  constructor(props, context) {\r\n    super(props, context);\r\n\r\n    this.handleClose = this.handleClose.bind(this);\r\n    this.handleQueryChange = this.handleQueryChange.bind(this);\r\n    this.findUsers = debounce(this.findUsers, 300, { trailing: true });\r\n    this.addContact = this.addContact.bind(this);\r\n    this.handleKeyDown = this.handleKeyDown.bind(this);\r\n    this.handleSelect = this.handleSelect.bind(this);\r\n  }\r\n\r\n  componentWillMount() {\r\n    document.addEventListener('keydown', this.handleKeyDown, false);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.refs.query.focus();\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    document.removeEventListener('keydown', this.handleKeyDown, false);\r\n  }\r\n\r\n  handleClose() {\r\n    AddContactActionCreators.close();\r\n  }\r\n\r\n  handleQueryChange(event) {\r\n    const query = event.target.value;\r\n    this.setState({ query });\r\n    this.findUsers(query);\r\n  }\r\n\r\n  findUsers(query) {\r\n    AddContactActionCreators.findUsers(query);\r\n  }\r\n\r\n  addContact() {\r\n    AddContactActionCreators.findUsers(this.state.query)\r\n  }\r\n\r\n  handleKeyDown(event) {\r\n    if (event.keyCode === KeyCodes.ENTER) {\r\n      event.preventDefault();\r\n      this.addContact()\r\n    }\r\n  }\r\n\r\n  handleSelect(uid, isContact) {\r\n    AddContactActionCreators.addToContacts(uid, isContact);\r\n    this.handleClose();\r\n  }\r\n\r\n  renderUserSearchInput() {\r\n    const { query } = this.state;\r\n    return (\r\n      <TextField\r\n        className=\"input__material--wide\"\r\n        floatingLabel={<FormattedMessage id=\"modal.addContact.query\"/>}\r\n        onChange={this.handleQueryChange}\r\n        ref=\"query\"\r\n        value={query}/>\r\n    );\r\n  }\r\n\r\n  renderUserSearchResults() {\r\n    const { query, results } = this.state;\r\n\r\n    if (!query || query.length === '') {\r\n      return (\r\n        <li className=\"add-contact__results__item add-contact__results__item--searching\">\r\n          <FormattedMessage id=\"modal.addContact.empty\"/>\r\n        </li>\r\n      );\r\n    }\r\n\r\n    // Disabled becouse searching is very fast and this message is blinking\r\n    // if (isSearching) {\r\n    //   return (\r\n    //     <li className=\"add-contact__results__item add-contact__results__item--searching\">\r\n    //       <FormattedMessage id=\"modal.addContact.searching\" values={{query}}/>\r\n    //     </li>\r\n    //   );\r\n    // }\r\n\r\n    if (results.length === 0) {\r\n      return (\r\n        <li className=\"add-contact__results__item add-contact__results__item--not-found\">\r\n          <FormattedMessage id=\"modal.addContact.notFound\"/>\r\n        </li>\r\n      );\r\n    }\r\n\r\n    return results.map((result, index) => {\r\n      return <ContactItem key={index} {...result} onSelect={this.handleSelect}/>\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Modal\r\n        overlayClassName=\"modal-overlay\"\r\n        className=\"modal\"\r\n        onRequestClose={this.handleClose}\r\n        contentLabel=\"\"\r\n        isOpen>\r\n\r\n        <div className=\"add-contact\">\r\n          <div className=\"modal__content\">\r\n\r\n            <header className=\"modal__header\">\r\n              <FormattedMessage id=\"modal.addContact.title\" tagName=\"h1\"/>\r\n              <a className=\"modal__header__close material-icons\"\r\n                 onClick={this.handleClose}>clear</a>\r\n            </header>\r\n\r\n            <div className=\"modal__body\">\r\n              {this.renderUserSearchInput()}\r\n            </div>\r\n\r\n            <footer className=\"modal__footer\">\r\n              <ul className=\"add-contact__results\">\r\n                {this.renderUserSearchResults()}\r\n              </ul>\r\n            </footer>\r\n\r\n          </div>\r\n        </div>\r\n\r\n      </Modal>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Container.create(AddContact);\r\n"]}