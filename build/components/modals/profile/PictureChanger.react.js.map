{"version":3,"sources":["../../../../src/components/modals/profile/PictureChanger.react.js"],"names":["PictureChanger","props","handleChangeAvatarClick","bind","handlePictureInputChange","event","imageInput","refs","click","fromModal","onChange","reader","FileReader","imageForm","file","files","onload","show","target","result","reset","readAsDataURL","renderPictureChanger","bigAvatar","placeholder","name","small","renderPictureRemover","onRemove","render","pictureChangerClassName","propTypes","string","isRequired","bool","oneOf","PROFILE","CREATE_GROUP","EDIT_GROUP","func"],"mappings":"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","file":"PictureChanger.react.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport React, { Component, PropTypes } from 'react';\r\nimport { findDOMNode } from 'react-dom';\r\nimport { FormattedMessage } from 'react-intl';\r\nimport { ModalTypes } from '../../../constants/ActorAppConstants';\r\nimport classnames from 'classnames';\r\n\r\nimport CropActionCreators from '../../../actions/CropActionCreators';\r\n\r\nimport AvatarItem from '../../common/AvatarItem.react';\r\n\r\nclass PictureChanger extends Component {\r\n  static propTypes = {\r\n    bigAvatar: PropTypes.string,\r\n    placeholder: PropTypes.string.isRequired,\r\n    name: PropTypes.string.isRequired,\r\n\r\n    small: PropTypes.bool,\r\n\r\n    fromModal: PropTypes.oneOf([\r\n      ModalTypes.PROFILE,\r\n      ModalTypes.CREATE_GROUP,\r\n      ModalTypes.EDIT_GROUP\r\n    ]).isRequired,\r\n\r\n    onRemove: PropTypes.func.isRequired,\r\n    onChange: PropTypes.func.isRequired\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.handleChangeAvatarClick = this.handleChangeAvatarClick.bind(this);\r\n    this.handlePictureInputChange = this.handlePictureInputChange.bind(this);\r\n  }\r\n\r\n  handleChangeAvatarClick(event) {\r\n    const imageInput = findDOMNode(this.refs.imageInput);\r\n    imageInput.click(event);\r\n  }\r\n\r\n  handlePictureInputChange() {\r\n    const { fromModal, onChange } = this.props;\r\n    const reader = new FileReader();\r\n    const imageForm = findDOMNode(this.refs.imageForm);\r\n    const file = findDOMNode(this.refs.imageInput).files[0];\r\n\r\n    reader.onload = (event) => {\r\n      CropActionCreators.show(event.target.result, fromModal, onChange);\r\n      imageForm.reset();\r\n    }\r\n    reader.readAsDataURL(file);\r\n  }\r\n\r\n  renderPictureChanger() {\r\n    const { bigAvatar, placeholder, name, small } = this.props;\r\n\r\n    return (\r\n      <div className=\"picture-changer__changer\">\r\n        <AvatarItem\r\n          className=\"picture-changer__avatar\"\r\n          image={bigAvatar}\r\n          placeholder={placeholder}\r\n          size={small ? 'big' : 'huge'}\r\n          title={name}\r\n        />\r\n\r\n        <a onClick={this.handleChangeAvatarClick}>\r\n          <FormattedMessage id=\"modal.profile.avatarChange\"/>\r\n        </a>\r\n\r\n      </div>\r\n    );\r\n  }\r\n\r\n  renderPictureRemover() {\r\n    const { bigAvatar } = this.props;\r\n    if (!bigAvatar) return null;\r\n\r\n    return (\r\n      <div className=\"picture-changer__controls\">\r\n        <a onClick={this.props.onRemove}>\r\n          <FormattedMessage id=\"modal.profile.avatarRemove\"/>\r\n        </a>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    const pictureChangerClassName = classnames('picture-changer', {\r\n      'picture-changer--small': this.props.small\r\n    })\r\n\r\n    return (\r\n      <div className={pictureChangerClassName}>\r\n        {this.renderPictureChanger()}\r\n        {this.renderPictureRemover()}\r\n\r\n        <form className=\"hide\" ref=\"imageForm\">\r\n          <input onChange={this.handlePictureInputChange} ref=\"imageInput\" type=\"file\"/>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n\r\nexport default PictureChanger;\r\n"]}