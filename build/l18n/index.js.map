{"version":3,"sources":["../../src/l18n/index.js"],"names":["extendL18n","getIntlData","language","navigator","toLocaleLowerCase","browserLanguage","buildMessages","defaultLanguage","process","env","NODE_ENV","flattenDefault","flattenMessages","messages","flattenLanguage","missingKeys","Object","keys","filter","key","length","groupMessage","locale","console","groupCollapsed","forEach","warn","groupEnd","languageData","delegate","get","l18n","english","default","russian","spanish","portuguese","chinese","nestedMessages","prefix","reduce","value","prefixedKey","assign","lang","currentLanguage","split"],"mappings":";;;QAkEgBA,U,GAAAA,U;QAyBAC,W,GAAAA,W;;AAvFhB;;;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;AAEA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;AAEA,4C,CArBA;;;;AAsBA;AACA;AACA;AACA;;AAEA,IAAIC,WAAWC,UAAUD,QAAV,CAAmBE,iBAAnB,MAA0CD,UAAUE,eAAV,CAA0BD,iBAA1B,EAAzD;AACA,IAAIF,aAAa,OAAjB,EAA0BA,WAAW,IAAX;;AAE1B,SAASI,aAAT,CAAuBC,eAAvB,EAAwCL,QAAxC,EAAkD;AAChD,MAAIM,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,aAA7B,EAA4C;AAC1C,QAAMC,iBAAiBC,gBAAgBL,gBAAgBM,QAAhC,CAAvB;AACA,QAAMC,kBAAkBF,gBAAgBV,SAASW,QAAzB,CAAxB;AACA,QAAME,cAAcC,OAAOC,IAAP,CAAYN,cAAZ,EAA4BO,MAA5B,CAAmC,UAACC,GAAD;AAAA,aAAS,CAACL,gBAAgBK,GAAhB,CAAV;AAAA,KAAnC,CAApB;AACA,QAAIJ,YAAYK,MAAhB,EAAwB;AACtB,UAAMC,uDAAqDnB,SAASoB,MAA9D,cAAN;AACAC,cAAQC,cAAR,CAAuBH,YAAvB;AACAN,kBAAYU,OAAZ,CAAoB,UAACN,GAAD,EAAS;AAC3BI,gBAAQG,IAAR,CAAgBP,GAAhB,UAAwBR,eAAeQ,GAAf,CAAxB;AACD,OAFD;AAGAI,cAAQI,QAAR,CAAiBN,YAAjB;AACD;AACF;;AAEDnB,WAASW,QAAT,GAAoB,0BAAW,EAAX,EAAeN,gBAAgBM,QAA/B,EAAyCX,SAASW,QAAlD,CAApB;AACD;;AAED;AACA,IAAMN,gCAAN;AACAD,cAAcC,eAAd;AACAD,cAAcC,eAAd;AACAD,cAAcC,eAAd;AACAD,cAAcC,eAAd;;AAEA;AACA,IAAMqB,eAAe;AACnB,aAAWrB,eADQ;AAEnB,sBAFmB;AAGnB,sBAHmB;AAInB,sBAJmB;AAKnB,sBALmB;AAMnB;AANmB,CAArB;;AASA;AACO,SAASP,UAAT,GAAsB;AAC3B,MAAM6B,WAAW,4BAAkBC,GAAlB,EAAjB;;AAEA,iBAAQjB,QAAR,GAAmBgB,SAASE,IAAT,CAAcC,OAAd,GAAwB,0BAAW,EAAX,EAAe,eAAQnB,QAAvB,EAAiCgB,SAASE,IAAT,CAAcE,OAAd,CAAsBpB,QAAvD,EAAiEgB,SAASE,IAAT,CAAcC,OAAd,CAAsBnB,QAAvF,CAAxB,GAA2H,eAAQA,QAAtJ;AACA,iBAAQA,QAAR,GAAmBgB,SAASE,IAAT,CAAcG,OAAd,GAAwB,0BAAW,EAAX,EAAe,eAAQrB,QAAvB,EAAiCgB,SAASE,IAAT,CAAcE,OAAd,CAAsBpB,QAAvD,EAAiEgB,SAASE,IAAT,CAAcG,OAAd,CAAsBrB,QAAvF,CAAxB,GAA2H,eAAQA,QAAtJ;AACA,iBAAQA,QAAR,GAAmBgB,SAASE,IAAT,CAAcI,OAAd,GAAwB,0BAAW,EAAX,EAAe,eAAQtB,QAAvB,EAAiCgB,SAASE,IAAT,CAAcE,OAAd,CAAsBpB,QAAvD,EAAiEgB,SAASE,IAAT,CAAcI,OAAd,CAAsBtB,QAAvF,CAAxB,GAA2H,eAAQA,QAAtJ;AACA,iBAAWA,QAAX,GAAsBgB,SAASE,IAAT,CAAcK,UAAd,GAA2B,0BAAW,EAAX,EAAe,eAAWvB,QAA1B,EAAoCgB,SAASE,IAAT,CAAcE,OAAd,CAAsBpB,QAA1D,EAAoEgB,SAASE,IAAT,CAAcK,UAAd,CAAyBvB,QAA7F,CAA3B,GAAoI,eAAWA,QAArK;AACA,iBAAQA,QAAR,GAAmBgB,SAASE,IAAT,CAAcM,OAAd,GAAwB,0BAAW,EAAX,EAAe,eAAQxB,QAAvB,EAAiCgB,SAASE,IAAT,CAAcE,OAAd,CAAsBpB,QAAvD,EAAiEgB,SAASE,IAAT,CAAcM,OAAd,CAAsBxB,QAAvF,CAAxB,GAA2H,eAAQA,QAAtJ;AACD;;AAED,SAASD,eAAT,CAAyB0B,cAAzB,EAAsD;AAAA,MAAbC,MAAa,uEAAJ,EAAI;;AACpD,SAAOvB,OAAOC,IAAP,CAAYqB,cAAZ,EAA4BE,MAA5B,CAAmC,UAAC3B,QAAD,EAAWM,GAAX,EAAmB;AAC3D,QAAIsB,QAAQH,eAAenB,GAAf,CAAZ;AACA,QAAIuB,cAAcH,SAAYA,MAAZ,SAAsBpB,GAAtB,GAA8BA,GAAhD;;AAEA,QAAI,OAAOsB,KAAP,KAAiB,QAArB,EAA+B;AAC7B5B,eAAS6B,WAAT,IAAwBD,KAAxB;AACD,KAFD,MAEO;AACLzB,aAAO2B,MAAP,CAAc9B,QAAd,EAAwBD,gBAAgB6B,KAAhB,EAAuBC,WAAvB,CAAxB;AACD;;AAED,WAAO7B,QAAP;AACD,GAXM,EAWJ,EAXI,CAAP;AAYD;;AAEM,SAASZ,WAAT,CAAqBqB,MAArB,EAA6B;AAClC,MAAMsB,OAAOtB,SAASA,MAAT,GAAkBpB,QAA/B;AACA,MAAM2C,kBAAkBjB,aAAagB,IAAb,KAAsBhB,aAAagB,KAAKE,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAb,CAAtB,IAA0DlB,aAAa,SAAb,CAAlF;;AAEA,SAAO;AACLN,YAAQuB,gBAAgBvB,MADnB;AAELT,cAAUD,gBAAgBiC,gBAAgBhC,QAAhC;AAFL,GAAP;AAID","file":"index.js","sourcesContent":["/*\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\n */\n\nimport assignDeep from 'assign-deep';\nimport DelegateContainer from '../utils/DelegateContainer';\n\nimport russian from './ru-RU';\nimport english from './en-US';\nimport spanish from './es-ES';\nimport portuguese from './pt-BR';\nimport chinese from './zh-CN';\n\nimport { addLocaleData } from 'react-intl';\n\nimport enLocaleData from 'react-intl/locale-data/en';\nimport ruLocaleData from 'react-intl/locale-data/ru';\nimport esLocaleData from 'react-intl/locale-data/es';\nimport ptLocaleData from 'react-intl/locale-data/pt';\nimport zhLocaleData from 'react-intl/locale-data/zh';\n\naddLocaleData(enLocaleData);\naddLocaleData(ruLocaleData);\naddLocaleData(esLocaleData);\naddLocaleData(ptLocaleData);\naddLocaleData(zhLocaleData);\n\nlet language = navigator.language.toLocaleLowerCase() || navigator.browserLanguage.toLocaleLowerCase();\nif (language === 'zh-cn') language = 'zh';\n\nfunction buildMessages(defaultLanguage, language) {\n  if (process.env.NODE_ENV === 'development') {\n    const flattenDefault = flattenMessages(defaultLanguage.messages);\n    const flattenLanguage = flattenMessages(language.messages);\n    const missingKeys = Object.keys(flattenDefault).filter((key) => !flattenLanguage[key])\n    if (missingKeys.length) {\n      const groupMessage = `There are missing transations for \"${language.locale}\" locale.`;\n      console.groupCollapsed(groupMessage);\n      missingKeys.forEach((key) => {\n        console.warn(`${key}: ${flattenDefault[key]}`);\n      });\n      console.groupEnd(groupMessage);\n    }\n  }\n\n  language.messages = assignDeep({}, defaultLanguage.messages, language.messages);\n}\n\n// Fallback to default language\nconst defaultLanguage = english;\nbuildMessages(defaultLanguage, russian);\nbuildMessages(defaultLanguage, spanish);\nbuildMessages(defaultLanguage, portuguese);\nbuildMessages(defaultLanguage, chinese);\n\n// Set language data\nconst languageData = {\n  'default': defaultLanguage,\n  'ru': russian,\n  'en': english,\n  'es': spanish,\n  'pt': portuguese,\n  'zh': chinese\n};\n\n// Extend language data from delegate\nexport function extendL18n() {\n  const delegate = DelegateContainer.get();\n\n  english.messages = delegate.l18n.english ? assignDeep({}, english.messages, delegate.l18n.default.messages, delegate.l18n.english.messages) : english.messages;\n  russian.messages = delegate.l18n.russian ? assignDeep({}, russian.messages, delegate.l18n.default.messages, delegate.l18n.russian.messages) : russian.messages;\n  spanish.messages = delegate.l18n.spanish ? assignDeep({}, spanish.messages, delegate.l18n.default.messages, delegate.l18n.spanish.messages) : spanish.messages;\n  portuguese.messages = delegate.l18n.portuguese ? assignDeep({}, portuguese.messages, delegate.l18n.default.messages, delegate.l18n.portuguese.messages) : portuguese.messages;\n  chinese.messages = delegate.l18n.chinese ? assignDeep({}, chinese.messages, delegate.l18n.default.messages, delegate.l18n.chinese.messages) : chinese.messages;\n}\n\nfunction flattenMessages(nestedMessages, prefix = '') {\n  return Object.keys(nestedMessages).reduce((messages, key) => {\n    let value = nestedMessages[key];\n    let prefixedKey = prefix ? `${prefix}.${key}` : key;\n\n    if (typeof value === 'string') {\n      messages[prefixedKey] = value;\n    } else {\n      Object.assign(messages, flattenMessages(value, prefixedKey));\n    }\n\n    return messages;\n  }, {});\n}\n\nexport function getIntlData(locale) {\n  const lang = locale ? locale : language;\n  const currentLanguage = languageData[lang] || languageData[lang.split('-')[0]] || languageData['default']\n\n  return {\n    locale: currentLanguage.locale,\n    messages: flattenMessages(currentLanguage.messages)\n  }\n}\n"]}