{"version":3,"sources":["../../src/l18n/index.js"],"names":["extendL18n","getIntlData","language","navigator","toLocaleLowerCase","browserLanguage","buildMessages","defaultLanguage","process","env","NODE_ENV","flattenDefault","flattenMessages","messages","flattenLanguage","missingKeys","Object","keys","filter","key","length","groupMessage","locale","console","groupCollapsed","forEach","warn","groupEnd","languageData","delegate","get","l18n","english","default","russian","spanish","portuguese","chinese","nestedMessages","prefix","reduce","value","prefixedKey","assign","lang","currentLanguage","split"],"mappings":"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","file":"index.js","sourcesContent":["/*\r\n * Copyright (C) 2015-2016 Actor LLC. <https://actor.im>\r\n */\r\n\r\nimport assignDeep from 'assign-deep';\r\nimport DelegateContainer from '../utils/DelegateContainer';\r\n\r\nimport russian from './ru-RU';\r\nimport english from './en-US';\r\nimport spanish from './es-ES';\r\nimport portuguese from './pt-BR';\r\nimport chinese from './zh-CN';\r\n\r\nimport { addLocaleData } from 'react-intl';\r\n\r\nimport enLocaleData from 'react-intl/locale-data/en';\r\nimport ruLocaleData from 'react-intl/locale-data/ru';\r\nimport esLocaleData from 'react-intl/locale-data/es';\r\nimport ptLocaleData from 'react-intl/locale-data/pt';\r\nimport zhLocaleData from 'react-intl/locale-data/zh';\r\n\r\naddLocaleData(enLocaleData);\r\naddLocaleData(ruLocaleData);\r\naddLocaleData(esLocaleData);\r\naddLocaleData(ptLocaleData);\r\naddLocaleData(zhLocaleData);\r\n\r\nlet language = navigator.language.toLocaleLowerCase() || navigator.browserLanguage.toLocaleLowerCase();\r\nif (language === 'zh-cn') language = 'zh';\r\n\r\nfunction buildMessages(defaultLanguage, language) {\r\n  if (process.env.NODE_ENV === 'development') {\r\n    const flattenDefault = flattenMessages(defaultLanguage.messages);\r\n    const flattenLanguage = flattenMessages(language.messages);\r\n    const missingKeys = Object.keys(flattenDefault).filter((key) => !flattenLanguage[key])\r\n    if (missingKeys.length) {\r\n      const groupMessage = `There are missing transations for \"${language.locale}\" locale.`;\r\n      console.groupCollapsed(groupMessage);\r\n      missingKeys.forEach((key) => {\r\n        console.warn(`${key}: ${flattenDefault[key]}`);\r\n      });\r\n      console.groupEnd(groupMessage);\r\n    }\r\n  }\r\n\r\n  language.messages = assignDeep({}, defaultLanguage.messages, language.messages);\r\n}\r\n\r\n// Fallback to default language\r\nconst defaultLanguage = english;\r\nbuildMessages(defaultLanguage, russian);\r\nbuildMessages(defaultLanguage, spanish);\r\nbuildMessages(defaultLanguage, portuguese);\r\nbuildMessages(defaultLanguage, chinese);\r\n\r\n// Set language data\r\nconst languageData = {\r\n  'default': defaultLanguage,\r\n  'ru': russian,\r\n  'en': english,\r\n  'es': spanish,\r\n  'pt': portuguese,\r\n  'zh': chinese\r\n};\r\n\r\n// Extend language data from delegate\r\nexport function extendL18n() {\r\n  const delegate = DelegateContainer.get();\r\n\r\n  english.messages = delegate.l18n.english ? assignDeep({}, english.messages, delegate.l18n.default.messages, delegate.l18n.english.messages) : english.messages;\r\n  russian.messages = delegate.l18n.russian ? assignDeep({}, russian.messages, delegate.l18n.default.messages, delegate.l18n.russian.messages) : russian.messages;\r\n  spanish.messages = delegate.l18n.spanish ? assignDeep({}, spanish.messages, delegate.l18n.default.messages, delegate.l18n.spanish.messages) : spanish.messages;\r\n  portuguese.messages = delegate.l18n.portuguese ? assignDeep({}, portuguese.messages, delegate.l18n.default.messages, delegate.l18n.portuguese.messages) : portuguese.messages;\r\n  chinese.messages = delegate.l18n.chinese ? assignDeep({}, chinese.messages, delegate.l18n.default.messages, delegate.l18n.chinese.messages) : chinese.messages;\r\n}\r\n\r\nfunction flattenMessages(nestedMessages, prefix = '') {\r\n  return Object.keys(nestedMessages).reduce((messages, key) => {\r\n    let value = nestedMessages[key];\r\n    let prefixedKey = prefix ? `${prefix}.${key}` : key;\r\n\r\n    if (typeof value === 'string') {\r\n      messages[prefixedKey] = value;\r\n    } else {\r\n      Object.assign(messages, flattenMessages(value, prefixedKey));\r\n    }\r\n\r\n    return messages;\r\n  }, {});\r\n}\r\n\r\nexport function getIntlData(locale) {\r\n  const lang = locale ? locale : language;\r\n  const currentLanguage = languageData[lang] || languageData[lang.split('-')[0]] || languageData['default']\r\n\r\n  return {\r\n    locale: currentLanguage.locale,\r\n    messages: flattenMessages(currentLanguage.messages)\r\n  }\r\n}\r\n"]}